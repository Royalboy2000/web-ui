<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Predator - Web Attack Panel</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <div id="particle-background"></div>

    <div class="main-container">
        <header class="global-header">
            <div class="logo-container">
                <i class="fa-solid fa-shield-halved logo-icon"></i>
            </div>
            <nav class="global-nav">
                <a href="#" class="nav-item" data-tooltip="Dashboard"><i class="fa-solid fa-table-columns"></i></a>
                <a href="#" class="nav-item active" data-tooltip="New Attack"><i class="fa-solid fa-crosshairs"></i></a>
                <a href="#" class="nav-item" data-tooltip="History"><i class="fa-solid fa-clock-rotate-left"></i></a>
                <a href="#" class="nav-item" data-tooltip="Settings"><i class="fa-solid fa-gear"></i></a>
            </nav>
        </header>

        <main class="content-area">

            <!-- Step 1: Target URL Input -->
            <div id="uiStep-TargetURL" class="wizard-step active">
                <div class="panel-container">
                    <div class="glass-panel form-panel">
                        <h1 class="panel-title">Step 1: Target URL</h1>
                        <p class="panel-subtitle">Enter the login page URL to analyze.</p>

                        <div class="form-group">
                             <input type="url" id="login-url" class="form-input" placeholder=" " required>
                             <label for="login-url" class="form-label">Login URL</label>
                        </div>

                        <button id="analyzeFormButton" class="btn btn-primary btn-analyze"> <!-- Used class_alias in prompt, but id is better for JS and class for styling -->
                            <span class="btn-text">Analyze Form</span>
                            <span class="spinner" style="display: none;"></span>
                        </button>

                        <p class="panel-subtitle" style="margin-top: 1.5rem; margin-bottom: 1.5rem; text-align: center; font-weight: bold;">&mdash; OR &mdash;</p>

                        <div class="form-group">
                            <label for="raw-request-input" class="form-label" style="position: static; transform: none; color: var(--text-color); font-size: 16px; margin-bottom: 8px; display:block;">
                                Paste Full HTTP Request:
                            </label>
                            <span class="micro-label" style="font-size: 11px; color: var(--text-color); opacity: 0.7; margin-bottom: 8px; display: block;">(e.g., from browser DevTools 'Copy as cURL (bash)' or 'Copy as fetch (PowerShell)', then simplify to basic request)</span>
                            <textarea id="raw-request-input" class="form-input" style="height: 150px; border: 1px solid var(--border-color); padding: 10px; line-height: 1.4; resize: vertical;" placeholder="Example:
POST /login HTTP/1.1
Host: example.com
Content-Type: application/x-www-form-urlencoded

username=test&password=123"></textarea>
                        </div>
                        <button id="parseRawRequestBtn" class="btn btn-secondary" style="width: 100%; margin-top: 0.5rem;">Parse Captured Request</button>
                    </div>
                    <div class="visualizer-panel">
                        <div class="screenshot-thumbnail">
                            <i class="fa-solid fa-camera"></i>
                            <p>Enter a URL to preview the target page</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Step 2: Analysis Review & Confirmation -->
            <div id="uiStep-AnalysisReview" class="wizard-step" style="display:none;">
                <div class="panel-container">
                    <div class="glass-panel form-panel">
                        <h1 class="panel-title">Step 2: Review Parameters</h1>
                        <p class="panel-subtitle">Confirm or edit the detected form parameters.</p>

                        <div id="form-analysis-results" class="form-analysis-results-panel" style="/* display: block; ensure it's visible when parent is */ padding-top: 0; border-top: none; margin-top:0;">
                            <!-- Display for parameters from captured request -->
                            <div id="capturedParamsDisplay" style="margin-top: 1.5rem; display:none;">
                                <h4 class="modal-subtitle" style="font-size: 16px; color: var(--primary-cyan); margin-bottom: 8px;">
                                    Parameters from Captured Request:
                                </h4>
                                <pre id="capturedParamsText" class="modal-code-block" style="max-height: 200px; margin-bottom: 10px;"></pre>
                                <p class="panel-subtitle" style="font-size: 12px; margin-top: 0px; opacity: 0.8;">
                                    Review the full list of parameters above. The tool has attempted to pre-fill the fields below based on common names. Please verify and correct if necessary.
                                </p>
                            </div>

                            <h3 class="panel-subtitle" style="margin-bottom: 1.5rem; font-size: 18px; color: var(--primary-magenta);">Detected Form Parameters</h3>
                            <div class="form-group">
                                <input type="text" id="detected-username-field" class="form-input" placeholder=" ">
                                <label for="detected-username-field" class="form-label">Username Field Name</label>
                            </div>
                            <div class="form-group">
                                <input type="text" id="detected-password-field" class="form-input" placeholder=" ">
                                <label for="detected-password-field" class="form-label">Password Field Name</label>
                            </div>
                            <div class="form-group">
                                <input type="text" id="detected-post-url" class="form-input" placeholder=" ">
                                <label for="detected-post-url" class="form-label">Form POST URL</label>
                            </div>
                            <!-- CSRF fields could be added here if manual input is desired -->
                        </div>

                        <button id="proceedToCredentialsBtn" class="btn btn-primary" style="margin-top: 1rem; width: 100%;">Proceed to Credentials</button>
                    </div>
                     <div class="visualizer-panel">
                        <div class="screenshot-thumbnail">
                            <i class="fa-solid fa-camera"></i>
                            <p>URL Analyzed. Review parameters.</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Step 3: Credentials Input & Launch -->
            <div id="uiStep-CredentialsInput" class="wizard-step" style="display:none;">
                <div class="panel-container">
                    <div class="glass-panel form-panel">
                        <h1 class="panel-title">Step 3: Provide Credentials</h1>
                        <p class="panel-subtitle">Upload username and password lists.</p>

                        <div class="form-group">
                            <label class="micro-label">Username/Email List File</label>
                            <div class="drop-zone">
                                <i class="fa-solid fa-users"></i>
                                <p>Drag & Drop .txt or .csv username/email list</p>
                                <input type="file" id="username-list-upload" accept=".txt,.csv" style="display: none;">
                                <button type="button" id="browse-username-files-btn" class="btn btn-secondary">Browse Username Files</button>
                                <p id="selected-username-file-name" class="selected-file-display">No file selected.</p>
                            </div>
                        </div>

                        <div class="form-group">
                             <label class="micro-label">Password List</label>
                             <div class="drop-zone">
                                 <i class="fa-solid fa-microchip"></i>
                                 <p>Drag & Drop .txt or .csv file</p>
                                 <input type="file" id="password-list-upload" accept=".txt,.csv" style="display: none;">
                                 <button type="button" id="browse-files-btn" class="btn btn-secondary">Browse Password Files</button>
                                 <p id="selected-password-file-name" class="selected-file-display">No password file selected.</p>
                             </div>
                        </div>

                        <button id="launchAttackBtn" class="btn btn-primary" style="width: 100%; margin-top: 1rem; background: linear-gradient(45deg, var(--primary-magenta), var(--success-lime));">
                            Launch Attack
                        </button>
                    </div>
                    <div class="visualizer-panel">
                        <div class="screenshot-thumbnail">
                            <i class="fa-solid fa-file-upload"></i>
                            <p>Ready for credential files.</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Step 2 from original design - Options & Payload (Currently Hidden / Bypassed) -->
            <div class="wizard-step" id="step2-options" style="display:none;"> <!-- Renamed id to avoid conflict if old step2 JS exists -->
                 <h1 class="panel-title">Options & Payload (Advanced)</h1>
                 <div class="options-grid">
                     <div class="glass-panel">
                         <label class="micro-label">Concurrency</label>
                         <div class="knob-ui">
                             <div class="knob-value">50</div>
                         </div>
                         <p class="panel-subtitle">Threads: 1 - 100</p>
                     </div>
                     <div class="glass-panel">
                         <label class="micro-label">Rate Limiter</label>
                         <img src="https://i.imgur.com/gD3I4sJ.png" alt="Waveform graph" style="width: 100%; opacity: 0.6; margin-top: 10px;">
                     </div>
                     <div class="glass-panel large-panel">
                         <label class="micro-label">Headers & Proxies (JSON)</label>
                         <div class="code-editor">
                            <pre><code>{
    "User-Agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36",
    "Accept-Language": "en-US,en;q=0.9",
    "proxies": [
        "http://user:pass@127.0.0.1:8080"
    ]
}</code></pre>
                         </div>
                     </div>
                 </div>
            </div>

            <!-- Step 4: Monitor Attack (was #step3) -->
            <div class="wizard-step" id="uiStep-Monitor">
                 <div class="monitor-header">
                     <h1 class="panel-title">Step 4: Monitor Attack</h1>
                     <div class="launch-controls">
                        <!-- Original LAUNCH button, functionality might be reassigned or removed if not used -->
                        <button class="btn-launch-cube">▶ LAUNCH</button>
                     </div>
                 </div>
                 <div class="monitor-grid">
                     <div class="glass-panel terminal-feed">
                         <div class="terminal-header">
                             <span>LIVE FEED</span>
                             <div class="terminal-filters">
                                 <span id="filter-all" class="active">ALL</span>
                                 <span id="filter-hits">HITS</span>
                                 <span id="filter-fails">FAILS</span>
                                 <span id="filter-content-length">CONTENT LENGTH</span>
                                 <span id="sort-cl-asc" class="sort-control" title="Sort by Content Length Ascending">▲</span>
                                 <span id="sort-cl-desc" class="sort-control" title="Sort by Content Length Descending">▼</span>
                                 <span id="filter-response">RESPONSE</span>
                             </div>
                         </div>
                         <div class="terminal-body">
                             <!-- Log messages will be dynamically inserted here by script.js -->
                             <p><span class="status-time">[INFO]</span><span class="status-info"> Awaiting attack initiation...</span></p>
                         </div>
                     </div>
                     <div class="metrics-hud">
                         <div class="hud-pod">
                             <label class="micro-label">TOTAL ATTEMPTS</label>
                             <span id="hud-total-attempts" class="hud-value">0</span>
                         </div>
                         <div class="hud-pod">
                            <label class="micro-label">HITS</label>
                            <span id="hud-hits" class="hud-value success-text">0</span>
                         </div>
                         <div class="hud-pod">
                            <label class="micro-label">ELAPSED TIME</label>
                            <span id="hud-elapsed-time" class="hud-value">00:00:00</span>
                         </div>
                         <div class="hud-pod">
                            <label class="micro-label">ETA</label>
                            <span id="hud-eta" class="hud-value">--:--:--</span>
                         </div>
                     </div>
                 </div>
            </div>

        </main>
    </div>

    <div id="responseModal" class="modal" style="display:none;">
        <div class="modal-content">
            <span id="modalCloseBtn" class="modal-close-btn">&times;</span>
            <h3 class="modal-title">HTTP Transaction Details</h3>

            <div class="modal-section">
                <h4 class="modal-subtitle">Request Details:</h4>
                <pre id="modalRequestDetails" class="modal-code-block"></pre>
            </div>

            <div class="modal-section">
                <h4 class="modal-subtitle">Response Body:</h4>
                <pre id="modalResponseBody" class="modal-code-block"></pre>
            </div>

            <div class="modal-section">
                <h4 class="modal-subtitle">Login Analysis Details:</h4>
                <p><strong>Score:</strong> <span id="modalLoginScore">N/A</span></p>

                <h5 class="modal-subtitle" style="font-size: 1em; margin-top: 10px;">Positive Indicators:</h5>
                <div id="modalPositiveIndicators" class="modal-code-block" style="max-height: 150px; overflow-y: auto;">N/A</div>

                <h5 class="modal-subtitle" style="font-size: 1em; margin-top: 10px;">Negative Indicators:</h5>
                <div id="modalNegativeIndicators" class="modal-code-block" style="max-height: 150px; overflow-y: auto;">N/A</div>
            </div>
        </div>
    </div>
    <script src="{{ url_for('static', filename='script.js') }}" defer></script>
</body>
</html>
