<!DOCTYPE html>
<html lang="en" data-theme="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Stryker - Advanced Security Suite</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Lexend:wght@400;500;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
    <div class="page-container">
        <aside class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <a href="#" class="logo">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M12 2L2 7V17L12 22L22 17V7L12 2Z" stroke="currentColor" stroke-width="2" stroke-linejoin="round"/><path d="M2 7L12 12M22 7L12 12M12 22V12M17 4.5L7 9.5" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>
                    <span>Stryker</span>
                </a>
            </div>
            <nav class="sidebar-nav">
                <a href="#icon-dashboard" class="nav-link active">
                    <svg class="icon"><use href="#icon-dashboard"/></svg>
                    <span>Dashboard</span>
                </a>
                <a href="#icon-target" class="nav-link">
                    <svg class="icon"><use href="#icon-target"/></svg>
                    <span>New Scan</span>
                </a>
                <a href="#icon-history" class="nav-link">
                    <svg class="icon"><use href="#icon-history"/></svg>
                    <span>History</span>
                    <span class="badge">3</span>
                </a>
                <a href="#icon-settings" class="nav-link">
                    <svg class="icon"><use href="#icon-settings"/></svg>
                    <span>Settings</span>
                </a>
            </nav>
            <div class="sidebar-footer">
                <a href="#icon-help" class="nav-link"> <!-- Also updating help link for consistency -->
                    <svg class="icon"><use href="#icon-help"/></svg>
                    <span>Help</span>
                </a>
                <div class="theme-switcher">
                    <input type="checkbox" id="theme-toggle" class="theme-toggle-checkbox">
                    <label for="theme-toggle" class="theme-toggle-label">
                        <svg class="icon icon-sun"><use href="#icon-sun"/></svg>
                        <svg class="icon icon-moon"><use href="#icon-moon"/></svg>
                    </label>
                </div>
            </div>
        </aside>

        <main class="main-content">
            <header class="main-header">
                <button class="sidebar-toggle" id="sidebar-toggle">
                    <svg class="icon"><use href="#icon-menu"/></svg>
                </button>
                <div class="header-actions">
                    <div class="search-bar">
                        <svg class="icon"><use href="#icon-search"/></svg>
                        <input type="text" placeholder="Search reports...">
                    </div>
                    <button class="icon-button tooltip" data-tooltip="Notifications">
                        <svg class="icon"><use href="#icon-bell"/></svg>
                        <span class="notification-dot"></span>
                    </button>
                    <div class="profile-dropdown">
                        <img src="https://i.pravatar.cc/40" alt="User Avatar">
                        <div class="profile-info">
                            <span class="profile-name">Alex Drake</span>
                            <span class="profile-role">Admin</span>
                        </div>
                        <svg class="icon icon-chevron"><use href="#icon-chevron-down"/></svg>
                    </div>
                </div>
            </header>

            <section class="content-section" id="dashboard-content">
                <div class="section-header">
                    <h1>Dashboard</h1>
                    <div class="header-buttons">
                        <button class="button button-secondary">Export Report</button>
                        <button class="button button-primary">Start New Scan</button>
                    </div>
                </div>

                <div class="card-grid">
                    <div class="card stat-card">
                        <div class="card-icon" style="--icon-bg: var(--color-primary-light); --icon-color: var(--color-primary);">
                            <svg class="icon"><use href="#icon-target"/></svg>
                        </div>
                        <div class="card-content">
                            <p class="stat-value">1,428</p>
                            <p class="stat-label">Total Scans</p>
                        </div>
                    </div>
                    <div class="card stat-card">
                        <div class="card-icon" style="--icon-bg: var(--color-success-light); --icon-color: var(--color-success);">
                            <svg class="icon"><use href="#icon-shield-check"/></svg>
                        </div>
                        <div class="card-content">
                            <p class="stat-value">98.2%</p>
                            <p class="stat-label">Success Rate</p>
                        </div>
                    </div>
                    <div class="card stat-card">
                        <div class="card-icon" style="--icon-bg: var(--color-warning-light); --icon-color: var(--color-warning);">
                            <svg class="icon"><use href="#icon-alert"/></svg>
                        </div>
                        <div class="card-content">
                            <p class="stat-value">12</p>
                            <p class="stat-label">Critical Alerts</p>
                        </div>
                    </div>

                    <div class="card form-card">
                        <div class="card-header">
                            <h2>Quick Scan</h2>
                            <span class="tooltip" data-tooltip="Enter a URL to run an immediate vulnerability scan.">
                                <svg class="icon"><use href="#icon-info"/></svg>
                            </span>
                        </div>
                        <form class="quick-scan-form">
                            <div class="form-group">
                                <input type="url" id="target-url" placeholder=" " required>
                                <label for="target-url">Target URL</label>
                            </div>
                            <button type="submit" class="button button-primary full-width" id="quick-scan-now-btn">Scan Now</button>
                        </form>
                        <div id="quick-scan-loading" style="display: none; text-align: center; margin-top: 10px;">
                            <p>Analyzing...</p>
                        </div>
                        <div id="quick-scan-error" style="display: none; color: var(--color-error); margin-top: 10px;">
                            {error message here}
                        </div>
                        <div id="quick-scan-results" style="display: none; margin-top: 15px;">
                            <h4>Analysis Results:</h4>
                            <pre id="quick-scan-results-data" style="max-height: 200px; overflow-y: auto;"></pre>
                            <button id="proceed-to-full-scan-btn" class="button button-secondary full-width" style="margin-top: 10px;">Proceed to Full Scan Setup</button>
                        </div>
                    </div>

                    <div class="card table-card">
                        <div class="card-header">
                            <h2>Recent Activity</h2>
                            <a href="#" class="link">View All</a>
                        </div>
                        <table>
                            <thead>
                                <tr>
                                    <th>Target</th>
                                    <th>Status</th>
                                    <th>Date</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>example.com</td>
                                    <td><span class="status-badge status-success">Complete</span></td>
                                    <td>2024-10-26</td>
                                    <td><button class="icon-button"><svg class="icon"><use href="#icon-download"/></svg></button></td>
                                </tr>
                                <tr>
                                    <td>secure-api.dev</td>
                                    <td><span class="status-badge status-warning">In Progress</span></td>
                                    <td>2024-10-26</td>
                                    <td><button class="icon-button"><svg class="icon"><use href="#icon-download"/></svg></button></td>
                                </tr>
                                <tr>
                                    <td>legacy-app.net</td>
                                    <td><span class="status-badge status-error">Failed</span></td>
                                    <td>2024-10-25</td>
                                    <td><button class="icon-button"><svg class="icon"><use href="#icon-download"/></svg></button></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </section>

            <section class="content-section" id="new-scan-content" style="display: none;">
                <!-- Step Indicator -->
                <div class="step-indicator-container card">
                    <div class="step-indicator active" data-step="1">
                        <span class="step-number">1</span>
                        <span class="step-label">Target</span>
                    </div>
                    <div class="step-indicator-arrow">&rarr;</div>
                    <div class="step-indicator" data-step="2">
                        <span class="step-number">2</span>
                        <span class="step-label">Parameters</span>
                    </div>
                    <div class="step-indicator-arrow">&rarr;</div>
                    <div class="step-indicator" data-step="3">
                        <span class="step-number">3</span>
                        <span class="step-label">Credentials</span>
                    </div>
                    <div class="step-indicator-arrow">&rarr;</div>
                    <div class="step-indicator" data-step="4">
                        <span class="step-number">4</span>
                        <span class="step-label">Monitor</span>
                    </div>
                </div>

                <!-- Step Sections -->
                <div class="scan-step-section card" id="scan-step-1">
                    <div class="section-header collapsible-header" data-target-step="1">
                        <h1>Step 1: Define Target</h1>
                        <svg class="icon icon-chevron-down"><use href="#icon-chevron-down"/></svg>
                    </div>
                    <div class="collapsible-content">
                        <div class="card-grid">
                            <div class="form-card">
                                <div class="card-header">
                                    <h2>Analyze Login Page URL</h2>
                                </div>
                                <form id="analyze-url-form">
                                    <div class="form-group">
                                        <input type="url" id="target-login-url" placeholder=" " required>
                                        <label for="target-login-url">Login Page URL</label>
                                    </div>
                                    <button type="submit" class="button button-primary full-width">Analyze Page</button>
                                </form>
                            </div>
                            <div class="form-card">
                                 <div class="card-header">
                                    <h2>Parse Raw HTTP Request</h2>
                                </div>
                                <form id="parse-request-form">
                                    <div class="form-group">
                                        <textarea id="raw-http-request" placeholder=" " style="height: 150px; width: 100%;" required></textarea>
                                        <label for="raw-http-request">Paste Full HTTP Request</label>
                                    </div>
                                    <button type="submit" class="button button-primary full-width">Parse Request</button>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="scan-step-section card" id="scan-step-2" style="display: none;">
                    <div class="section-header collapsible-header" data-target-step="2">
                        <h1>Step 2: Review & Configure Parameters</h1>
                        <svg class="icon icon-chevron-down"><use href="#icon-chevron-down"/></svg>
                    </div>
                    <div class="collapsible-content" style="display: none;">
                        <div class="card-grid">
                            <div class="form-card">
                                <div class="card-header"><h2>Detected Parameters</h2></div>
                                <form id="parameters-form">
                                    <div class="form-group">
                                        <input type="text" id="detected-post-url" placeholder=" ">
                                        <label for="detected-post-url">Form POST URL</label>
                                    </div>
                                    <div class="form-group">
                                        <input type="text" id="detected-username-field" placeholder=" ">
                                        <label for="detected-username-field">Username Field Name</label>
                                    </div>
                                    <div class="form-group">
                                        <input type="text" id="detected-password-field" placeholder=" ">
                                        <label for="detected-password-field">Password Field Name</label>
                                    </div>
                                    <div class="form-group">
                                        <input type="text" id="detected-csrf-name" placeholder=" ">
                                        <label for="detected-csrf-name">CSRF Token Name (if any)</label>
                                    </div>
                                    <div class="form-group">
                                        <input type="text" id="detected-csrf-value" placeholder=" ">
                                        <label for="detected-csrf-value">CSRF Token Value (if any)</label>
                                    </div>
                                    <div id="raw-request-params-display" style="display:none;">
                                        <h4>Additional Parameters from Raw Request:</h4>
                                        <pre id="raw-request-params-data"></pre>
                                    </div>
                                    <div id="raw-request-cookies-display" style="display:none;">
                                        <h4>Cookies from Raw Request:</h4>
                                        <pre id="raw-request-cookies-data"></pre>
                                    </div>
                                      <div id="analysis-cookies-display" style="display:none;">
                                        <h4>Cookies from URL Analysis:</h4>
                                        <pre id="analysis-cookies-data"></pre>
                                    </div>
                                    <button type="button" id="confirm-params-btn" class="button button-primary full-width" style="margin-top:1rem;">Confirm Parameters & Proceed</button>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="scan-step-section card" id="scan-step-3" style="display: none;">
                    <div class="section-header collapsible-header" data-target-step="3">
                        <h1>Step 3: Provide Credentials</h1>
                        <svg class="icon icon-chevron-down"><use href="#icon-chevron-down"/></svg>
                    </div>
                    <div class="collapsible-content" style="display: none;">
                        <div class="card-grid">
                             <div class="form-card">
                                <div class="card-header"><h2>Upload Username:Password Combo File</h2></div>
                                <form id="combo-file-form">
                                    <div class="form-group">
                                        <input type="file" id="combo-file-input" accept=".txt,.csv">
                                        <label for="combo-file-input" class="button button-secondary" style="width:auto; margin-top: 5px;">Browse Combo File</label>
                                        <p id="combo-file-name" style="margin-top: 5px; font-size: 0.9rem;"></p>
                                    </div>
                                </form>
                            </div>
                            <div class="form-card">
                                <div class="card-header"><h2>Provide Separate Lists (if no combo file)</h2></div>
                                <form id="separate-lists-form">
                                    <div class="form-group">
                                        <input type="file" id="username-list-input" accept=".txt,.csv">
                                         <label for="username-list-input" class="button button-secondary" style="width:auto; margin-top: 5px;">Browse Username File</label>
                                         <p id="username-list-file-name" style="margin-top: 5px; font-size: 0.9rem;"></p>
                                        <input type="text" id="single-username-input" placeholder="Or type single username/email here" style="margin-top: 10px;">
                                    </div>
                                    <div class="form-group">
                                        <input type="file" id="password-list-input" accept=".txt,.csv">
                                        <label for="password-list-input" class="button button-secondary" style="width:auto; margin-top: 5px;">Browse Password File</label>
                                        <p id="password-list-file-name" style="margin-top: 5px; font-size: 0.9rem;"></p>
                                    </div>
                                </form>
                            </div>
                        </div>
                         <button type="button" id="proceed-to-launch-btn" class="button button-primary full-width" style="margin-top:1rem;">Proceed to Launch</button>
                    </div>
                </div>

                <div class="scan-step-section card" id="scan-step-4" style="display: none;">
                    <div class="section-header collapsible-header" data-target-step="4">
                        <h1>Step 4: Launch & Monitor</h1>
                        <svg class="icon icon-chevron-down"><use href="#icon-chevron-down"/></svg>
                    </div>
                    <div class="collapsible-content" style="display: none;">
                        <button id="launch-attack-btn" class="button button-primary full-width" style="margin-bottom: var(--spacing-4); background: linear-gradient(45deg, var(--color-error), var(--color-warning));">Launch Attack</button>

                        <div class="card-grid" style="gap: var(--spacing-4); margin-bottom: var(--spacing-4);">
                            <!-- Metrics cards -->
                            <div class="stat-card" style="background-color: var(--color-secondary); padding: var(--spacing-3);">
                                <div class="card-content">
                                    <p class="stat-label" style="font-size: 0.8rem;">Total Attempts</p>
                                    <p class="stat-value" id="metric-total-attempts" style="font-size: 1.5rem;">0/0</p>
                                </div>
                            </div>
                            <div class="stat-card" style="background-color: var(--color-secondary); padding: var(--spacing-3);">
                                <div class="card-content">
                                    <p class="stat-label" style="font-size: 0.8rem;">Hits</p>
                                    <p class="stat-value" id="metric-hits" style="font-size: 1.5rem; color: var(--color-success);">0</p>
                                </div>
                            </div>
                            <div class="stat-card" style="background-color: var(--color-secondary); padding: var(--spacing-3);">
                                <div class="card-content">
                                    <p class="stat-label" style="font-size: 0.8rem;">Elapsed Time</p>
                                    <p class="stat-value" id="metric-elapsed-time" style="font-size: 1.5rem;">00:00:00</p>
                                </div>
                            </div>
                             <div class="stat-card" style="background-color: var(--color-secondary); padding: var(--spacing-3);">
                                <div class="card-content">
                                    <p class="stat-label" style="font-size: 0.8rem;">ETA</p>
                                    <p class="stat-value" id="metric-eta" style="font-size: 1.5rem;">--:--:--</p>
                                </div>
                            </div>
                        </div>

                        <div class="log-filter-controls" style="margin-bottom: var(--spacing-3); text-align: right;">
                            <span style="margin-right: var(--spacing-2); font-weight: 500;">Filter:</span>
                            <button class="button button-secondary button-sm" data-filter="all">All</button>
                            <button class="button button-secondary button-sm" data-filter="success">Success</button>
                            <button class="button button-secondary button-sm" data-filter="failure">Failure</button>
                            <button class="button button-secondary button-sm" data-filter="error">Error/Unknown</button>
                        </div>

                        <div class="table-responsive-wrapper" style="overflow-x: auto;">
                            <table id="live-feed-table" class="styled-table" style="width:100%;">
                                <thead>
                                    <tr>
                                        <th>#</th>
                                        <th>Timestamp</th>
                                        <th>Username</th>
                                        <th>Password</th>
                                        <th>Status</th>
                                        <th>HTTP Code</th>
                                        <th>Length</th>
                                        <th>Details</th>
                                    </tr>
                                </thead>
                                <tbody id="live-feed-tbody">
                                    <!-- Log rows will be appended here by JS -->
                                </tbody>
                            </table>
                        </div>
                        <div id="live-feed-placeholder" style="display: none; text-align: center; padding: var(--spacing-6); color: var(--color-text-secondary);">
                            <p>[INFO] Awaiting attack initiation...</p>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Details Modal -->
            <div id="log-details-modal" class="modal" style="display: none;">
                <div class="modal-content card" style="max-width: 800px;">
                    <div class="modal-header card-header">
                        <h2 id="modal-title">Attempt Details</h2>
                        <button id="modal-close-btn" class="icon-button">&times;</button>
                    </div>
                    <div class="modal-body" style="padding: var(--spacing-6);">
                        <h4>Request Information:</h4>
                        <pre id="modal-request-info"></pre>
                        <h4>Response Information:</h4>
                        <pre id="modal-response-info"></pre>
                        <h4>Analysis Summary:</h4>
                        <pre id="modal-analysis-summary"></pre>
                    </div>
                </div>
            </div>

            <!-- NO DUPLICATED SECTION HERE IN THE CORRECTED VERSION -->

        </main>
    </div>

    <svg style="display: none;">
        <symbol id="icon-dashboard" viewBox="0 0 24 24"><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 13V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2zm0 0l6-3l6 3m-6-8v11"/></symbol>
        <symbol id="icon-target" viewBox="0 0 24 24"><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 21a9 9 0 1 0-9-9a9 9 0 0 0 9 9zm0-4a5 5 0 1 0-5-5a5 5 0 0 0 5 5zm0-2a3 3 0 1 0-3-3a3 3 0 0 0 3 3z"/></symbol>
        <symbol id="icon-history" viewBox="0 0 24 24"><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m5-3a9 9 0 1 1-18 0a9 9 0 0 1 18 0z"/></symbol>
        <symbol id="icon-settings" viewBox="0 0 24 24"><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19.14 12a7.14 7.14 0 0 1-7.14 7.14a7.14 7.14 0 0 1-7.14-7.14a7.14 7.14 0 0 1 7.14-7.14a7.14 7.14 0 0 1 7.14 7.14zm-4.28 0a2.86 2.86 0 1 1-5.72 0a2.86 2.86 0 0 1 5.72 0z"/></symbol>
        <symbol id="icon-help" viewBox="0 0 24 24"><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 21a9 9 0 1 0-9-9c0 2.12.74 4.09 2 5.59l-2 3.41l3.41-2A8.93 8.93 0 0 0 12 21z"/></symbol>
        <symbol id="icon-sun" viewBox="0 0 24 24"><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364-6.364l-.707.707M6.343 17.657l-.707.707m12.02-.707l-.707-.707M6.343 6.343l-.707-.707M12 17a5 5 0 1 0 0-10a5 5 0 0 0 0 10z"/></symbol>
        <symbol id="icon-moon" viewBox="0 0 24 24"><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 12.79A9 9 0 1 1 11.21 3A7 7 0 0 0 21 12.79z"/></symbol>
        <symbol id="icon-menu" viewBox="0 0 24 24"><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"/></symbol>
        <symbol id="icon-search" viewBox="0 0 24 24"><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-4.35-4.35M11 19a8 8 0 1 0 0-16a8 8 0 0 0 0 16z"/></symbol>
        <symbol id="icon-bell" viewBox="0 0 24 24"><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9m-4.27 11a2 2 0 0 1-3.46 0"/></symbol>
        <symbol id="icon-chevron-down" viewBox="0 0 24 24"><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m6 9l6 6l6-6"/></symbol>
        <symbol id="icon-shield-check" viewBox="0 0 24 24"><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2l4-4m6 2a9 9 0 1 1-18 0a9 9 0 0 1 18 0z"/></symbol>
        <symbol id="icon-alert" viewBox="0 0 24 24"><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v4m0 4h.01M21 12a9 9 0 1 1-18 0a9 9 0 0 1 18 0z"/></symbol>
        <symbol id="icon-info" viewBox="0 0 24 24"><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 16v-4m0-4h.01M21 12a9 9 0 1 1-18 0a9 9 0 0 1 18 0z"/></symbol>
        <symbol id="icon-download" viewBox="0 0 24 24"><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4m4-5l5 5l5-5m-5 5V3"/></symbol>
    </svg>

    <script src="{{ url_for('static', filename='script.js') }}"></script>
</body>
</html>
